(this["webpackJsonpsubtitle-editor"]=this["webpackJsonpsubtitle-editor"]||[]).push([[0],{35:function(t,e,n){},43:function(t,e,n){},44:function(t,e,n){},45:function(t,e,n){},46:function(t,e,n){},47:function(t,e,n){},48:function(t,e,n){},49:function(t,e,n){},50:function(t,e,n){},52:function(t,e,n){},53:function(t,e,n){},54:function(t,e,n){"use strict";n.r(e);var a=n(0),i=n(1),s=n.n(i),c=n(26),o=n.n(c),r=n(3),l=n(4),u=n(6),d=n(5),h=n(16),p=n(8),b=n(20),m=n.n(b),f=n(27),j=n(2),v=(n(35),function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).state=void 0,a.fileInput=void 0,a.state={filename:""},a.fileInput=Object(i.createRef)(),a.changeHandler=a.changeHandler.bind(Object(j.a)(a)),a.redirectToInput=a.redirectToInput.bind(Object(j.a)(a)),a}return Object(l.a)(n,[{key:"changeHandler",value:function(t){var e,n=t.target;if(this.props.onChange&&(null===(e=n.files)||void 0===e?void 0:e.length)){var a=n.files[0];this.props.onChange(a),this.setState({filename:a.name})}}},{key:"redirectToInput",value:function(){var t;null===(t=this.fileInput.current)||void 0===t||t.click()}},{key:"render",value:function(){var t=this,e=this.state.filename,n=e?"[".concat(e,"] click to rechoose"):"choose a file";return Object(a.jsxs)("div",{className:"form-group file-input-wrapper",children:[Object(a.jsx)("input",{type:"file",ref:this.fileInput,className:"d-none",onChange:this.changeHandler}),Object(a.jsx)("button",{className:"rounded font-weight-bold btn btn-info w-100 virtual-file-input",onClick:function(e){return t.redirectToInput()},children:Object(a.jsxs)("span",{children:[" ",n," "]})})]})}}]),n}(s.a.Component)),O=function(){function t(e){Object(r.a)(this,t),this.data=void 0,this.data=e}return Object(l.a)(t,[{key:"getData",value:function(){return this.data}},{key:"setData",value:function(t){this.data=t}}]),t}(),C={videoUrl:new O(""),subtitles:new O([])};function g(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=1;n<=e;){var a=Math.pow(10,n);if(!(t>=a))break;n++}return"0".repeat(e-n)+String(t)}function y(t,e){var n=Math.floor(t%1*1e3),a=Math.floor(t%60),i=Math.floor(t%3600/60),s=Math.floor(t/3600);return"minute"===e?"".concat(g(i),":").concat(g(a)):"minute+ms"===e?"".concat(g(i),":").concat(g(a),".").concat(g(n,3)):"complete"===e?"".concat(g(s),":").concat(g(i),":").concat(g(a),",").concat(g(n,3)):""}function x(t){return 60*Number(t.slice(0,2))*60+60*Number(t.slice(3,5))+Number(t.slice(6,8))+Number(t.slice(9))/1e3}var k=n(15);var T=function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).state={subtitleUrl:"",videoUrl:"",canPass:!1},a.handler=a.handler.bind(Object(j.a)(a)),a.loadCaptions=a.loadCaptions.bind(Object(j.a)(a)),a.checkValidation=a.checkValidation.bind(Object(j.a)(a)),a}return Object(l.a)(n,[{key:"loadCaptions",value:function(){var t=Object(f.a)(m.a.mark((function t(){var e,n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==this.state.subtitleUrl){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,fetch(this.state.subtitleUrl);case 4:return e=t.sent,t.next=7,e.text();case 7:n=t.sent,C.subtitles.setData((a=n,Array.from(a.matchAll(/[0-9]+\n([,0-:]{12}) \x2D\x2D> ([,0-:]{12})\n([\s\S]+?)(?=[0-9]+\n[,0-:]{12}|$)/g)).map((function(t){return{start:x(t[1]),end:x(t[2]),content:t[3].trim(),hash:Object(k.v4)()}}))));case 9:case"end":return t.stop()}var a}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"handler",value:function(t,e){var n=URL.createObjectURL(t);"video"===e?(C.videoUrl.setData(n),this.setState({videoUrl:n},this.loadCaptions)):this.setState({subtitleUrl:n},this.loadCaptions)}},{key:"checkValidation",value:function(){this.state.videoUrl&&this.setState({canPass:!0})}},{key:"render",value:function(){var t=this;return this.state.canPass?Object(a.jsx)(p.a,{to:"/subtitle-edtior/studio"}):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h2",{className:"page-title",children:"Intro"}),Object(a.jsxs)("div",{className:"wrapper",children:[Object(a.jsxs)("div",{className:"alert alert-secondary",children:["consider\u200c ",Object(a.jsx)(h.b,{to:"/subtitle-edtior/help",children:"\u200chelp page\u200c"})," for learning shortcuts"]}),Object(a.jsxs)("div",{children:[Object(a.jsx)("span",{children:"video file:"}),Object(a.jsx)(v,{onChange:function(e){return t.handler(e,"video")}})]}),Object(a.jsxs)("div",{className:"alert alert-info",children:["you can check supported video formats",Object(a.jsx)("a",{href:"https://en.wikipedia.org/wiki/HTML5_video",target:"blank",children:" here "})]}),Object(a.jsxs)("div",{className:"mt-3",children:[Object(a.jsx)("span",{children:"subtitle file:"}),Object(a.jsx)(v,{onChange:function(e){return t.handler(e,"subtitle")}})]}),Object(a.jsx)("div",{className:"alert alert-warning",children:"if you don't select a subtitle file, we make new one"}),Object(a.jsx)("div",{className:"center",children:Object(a.jsx)("button",{className:"btn btn-success font-weight-bold",onClick:this.checkValidation,children:"go to studio!"})})]})]})}}]),n}(s.a.Component),N=n(7),S=n(17),w=(n(43),function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).inputRef=void 0,a.state={my_caption:null,content2change:""},a.inputRef=s.a.createRef(),a.onCaptionContentChanged=a.onCaptionContentChanged.bind(Object(j.a)(a)),a.onCaptionTimeRangeChanged=a.onCaptionTimeRangeChanged.bind(Object(j.a)(a)),a.handleCaptionChange=a.handleCaptionChange.bind(Object(j.a)(a)),a.isCapInTimeRange=a.isCapInTimeRange.bind(Object(j.a)(a)),a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(N.a)("alt+left",(function(){t.onCaptionTimeRangeChanged(-.5,0)})),Object(N.a)("alt+right",(function(){t.onCaptionTimeRangeChanged(.5,0)})),Object(N.a)("tab+left",(function(e){e.preventDefault(),t.onCaptionTimeRangeChanged(0,-.5)})),Object(N.a)("tab+right",(function(e){e.preventDefault(),t.onCaptionTimeRangeChanged(0,.5)}))}},{key:"componentDidUpdate",value:function(){var t;(null===this.props.caption&&null!==this.state.my_caption||null!==this.props.caption&&this.props.caption.hash!==(null===(t=this.state.my_caption)||void 0===t?void 0:t.hash))&&(this.handleCaptionChange(),this.setState({my_caption:null===this.props.caption?null:Object(S.a)({},this.props.caption),content2change:null!==this.props.caption?this.props.caption.content:""}))}},{key:"isCapInTimeRange",value:function(t){return t>=0&&t<=this.props.totalTime}},{key:"onCaptionContentChanged",value:function(t){this.setState({content2change:t.target.value})}},{key:"onCaptionTimeRangeChanged",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(null!==this.state.my_caption){var n=this.state.my_caption;null===t?n.start=this.props.currentTime:this.isCapInTimeRange(n.start+t)&&(n.start+=t),null===e?n.end=this.props.currentTime:this.isCapInTimeRange(n.end+e)&&(n.end+=e),n.start>n.end&&(0===e?n.end=n.start:n.start=n.end),this.handleCaptionChange()}}},{key:"handleCaptionChange",value:function(){if(null!==this.state.my_caption){var t=Object(S.a)(Object(S.a)({},this.state.my_caption),{},{content:this.state.content2change});this.props.onCaptionChanged(t)}}},{key:"render",value:function(){var t,e=this,n=this.props.caption;return n&&(null===(t=this.inputRef.current)||void 0===t||t.focus()),Object(a.jsxs)("div",{className:"caption-editor-wrapper",children:[n?Object(a.jsx)(H,{time:n.start,onChange:function(t){e.onCaptionTimeRangeChanged(t,0)}}):Object(a.jsx)(H,{time:0}),Object(a.jsx)("div",{children:Object(a.jsx)("input",{type:"text",ref:this.inputRef,className:"form-control caption-editor "+(n?"":"invisible"),value:this.state.content2change,onChange:this.onCaptionContentChanged,onBlur:this.handleCaptionChange})}),n?Object(a.jsx)(H,{time:n.end,onChange:function(t){e.onCaptionTimeRangeChanged(0,t)}}):Object(a.jsx)(H,{time:0})]})}}]),n}(s.a.Component)),R=(n(44),function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).getCaptionContent=a.getCaptionContent.bind(Object(j.a)(a)),a}return Object(l.a)(n,[{key:"getCaptionContent",value:function(){var t=this.props.currentTime,e=this.props.captions.find((function(e){return t>=e.start&&t<=e.end}));return e?e.content:""}},{key:"render",value:function(){var t=this.getCaptionContent();return Object(a.jsx)("div",{className:"caption-group",children:""===t?"":Object(a.jsx)("div",{className:"caption",children:t})})}}]),n}(s.a.Component)),_=(n(45),function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).handleClick=a.handleClick.bind(Object(j.a)(a)),a}return Object(l.a)(n,[{key:"handleClick",value:function(t){var e=this.props.onSelectNewTime;if(e){var n=t.currentTarget;e((t.pageX-n.offsetLeft)/n.clientWidth*this.props.totalTime)}}},{key:"render",value:function(){if(void 0===this.props.totalTime)return"";var t=this.props.currentTime/this.props.totalTime*100,e=y(this.props.currentTime,"minute"),n=y(this.props.totalTime,"minute");return Object(a.jsxs)("div",{className:"timeline "+this.props.className,onClick:this.handleClick,children:[Object(a.jsxs)("div",{className:"progress",children:[Object(a.jsx)("div",{className:"progress-bar",style:{width:"".concat(t,"%")}}),Object(a.jsx)("div",{className:"cursor"})]}),Object(a.jsx)("div",{className:"time-text-wrapper",children:Object(a.jsxs)("div",{className:"time-text",children:[Object(a.jsxs)("span",{children:[" ",e," "]}),Object(a.jsx)("span",{children:" - "}),Object(a.jsxs)("span",{children:[" ",n," "]})]})})]})}}]),n}(s.a.Component)),E=(n(46),function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).videoElementRef=void 0,a.timer=0,a.state=void 0,a.state={lastStart:0,showVideoControll:!1},a.videoElementRef=s.a.createRef(),a.onTimeUpdate=a.onTimeUpdate.bind(Object(j.a)(a)),a.onMouseMove=a.onMouseMove.bind(Object(j.a)(a)),a.onError=a.onError.bind(Object(j.a)(a)),a.setPlay=a.setPlay.bind(Object(j.a)(a)),a.isPlaying=a.isPlaying.bind(Object(j.a)(a)),a.disableVideoControllers=a.disableVideoControllers.bind(Object(j.a)(a)),a.onDurationChanges=a.onDurationChanges.bind(Object(j.a)(a)),a}return Object(l.a)(n,[{key:"onDurationChanges",value:function(){if(this.props.onDurationChanges){var t,e=(null===(t=this.videoElementRef.current)||void 0===t?void 0:t.duration)||0;this.props.onDurationChanges(e)}}},{key:"onTimeUpdate",value:function(t){if(this.props.onTimeUpdate){var e=t.currentTarget.currentTime;this.props.onTimeUpdate(e)}}},{key:"onMouseMove",value:function(t){this.timer&&clearTimeout(this.timer),this.setState({showVideoControll:!0}),this.timer=+setTimeout(this.disableVideoControllers,2e3)}},{key:"onError",value:function(t){this.props.onError&&this.props.onError(t)}},{key:"disableVideoControllers",value:function(){clearTimeout(this.timer),this.setState({showVideoControll:!1})}},{key:"setTime",value:function(t){var e=this.videoElementRef.current;e&&(e.currentTime=t)}},{key:"shootTime",value:function(t){var e=this.videoElementRef.current;if(e){var n=e.currentTime;this.setTime(n+t)}}},{key:"setPlay",value:function(t){var e,n;this.videoElementRef.current&&(t?null===(e=this.videoElementRef.current)||void 0===e||e.play():null===(n=this.videoElementRef.current)||void 0===n||n.pause())}},{key:"togglePlay",value:function(){this.setPlay(!this.isPlaying())}},{key:"isPlaying",value:function(){return Boolean(this.videoElementRef.current&&!this.videoElementRef.current.paused)}},{key:"render",value:function(){var t=this,e=this.isPlaying();return Object(a.jsx)("div",{className:"video-player "+(this.state.showVideoControll?"show ":""),onMouseMove:this.onMouseMove,onMouseOut:this.disableVideoControllers,children:Object(a.jsxs)("div",{className:"video-screen",onContextMenu:function(t){return t.preventDefault()},children:[Object(a.jsx)("video",{onTimeUpdate:this.onTimeUpdate,ref:this.videoElementRef,src:this.props.videoUrl,autoPlay:!1,loop:!1,onDurationChange:this.onDurationChanges,onError:function(e){return t.onError(e)}}),Object(a.jsxs)("div",{className:"video-state-controller",children:[Object(a.jsx)("div",{className:"part"}),Object(a.jsx)("div",{className:"part action-btn-group",children:Object(a.jsx)("div",{className:"action-btn play-pause",onClick:function(){return t.setPlay(!e)},children:Object(a.jsx)("span",{className:"icon fas fa-3x "+(e?"fa-pause":"fa-play")})})}),Object(a.jsx)("div",{className:"part"})]})]})})}}]),n}(s.a.Component)),D=(n(47),function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(){return Object(r.a)(this,n),e.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)("div",{className:"d-inline-block "+this.props.className,children:[Object(a.jsx)("button",{className:"btn circle-btn add-caption-btn "+(this.props.disabled?"disabled":""),onClick:this.props.onClick,children:Object(a.jsx)("span",{className:this.props.iconClassName})}),this.props.text?Object(a.jsx)("div",{className:"badge",children:Object(a.jsxs)("span",{children:[" ",this.props.text," "]})}):""]})})}}]),n}(s.a.Component)),P=(n(48),function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).canvasRef=void 0,a.state={error:!1,lastScale:0,scale:0},a.canvasRef=s.a.createRef(),a.captionSelectionHandler=a.captionSelectionHandler.bind(Object(j.a)(a)),a.drawTimeRuler=a.drawTimeRuler.bind(Object(j.a)(a)),a.setTimeFromPixels=a.setTimeFromPixels.bind(Object(j.a)(a)),a.zoom=a.zoom.bind(Object(j.a)(a)),a.zoomIn=a.zoomIn.bind(Object(j.a)(a)),a.zoomOut=a.zoomOut.bind(Object(j.a)(a)),a.isZoomInValid=a.isZoomInValid.bind(Object(j.a)(a)),a.isZoomOutValid=a.isZoomOutValid.bind(Object(j.a)(a)),a}return Object(l.a)(n,[{key:"captionSelectionHandler",value:function(t){this.props.onCaptionSelected(t)}},{key:"zoom",value:function(t){var e=this.state.scale+t;this.isZoomInValid(e)&&this.isZoomOutValid(e)&&this.setState({scale:e})}},{key:"isZoomInValid",value:function(t){return t<=100&&t*this.props.duration<=32767}},{key:"isZoomOutValid",value:function(t){return t>0}},{key:"zoomIn",value:function(){this.zoom(10)}},{key:"zoomOut",value:function(){this.zoom(-10)}},{key:"setTimeFromPixels",value:function(t){this.props.onSelectNewTime(t/this.state.scale)}},{key:"drawTimeRuler",value:function(){var t,e=null===(t=this.canvasRef.current)||void 0===t?void 0:t.getContext("2d");if(e)for(var n=0;n<this.props.duration;n++){var a=y(n,"minute");this.state.scale<20?n%5===0&&e.fillText(a,this.state.scale*n-12,20):this.state.scale<30?n%3===0&&e.fillText(a,this.state.scale*n-12,20):this.state.scale<40?e.fillText(a,this.state.scale*n-12,n%2===1?12:20):e.fillText(a,this.state.scale*n-12,20),e.fillRect(this.state.scale*n,24,2,10)}}},{key:"componentDidMount",value:function(){var t=this;Object(N.a)("ctrl+=",(function(e){e.preventDefault(),t.zoomIn()})),Object(N.a)("ctrl+-",(function(e){e.preventDefault(),t.zoomOut()}))}},{key:"componentDidUpdate",value:function(){if(0!==this.props.duration)if(0===this.state.scale){for(var t=30;t*this.props.duration>32767;)t-=10;t<=0?this.setState({error:!0,scale:-1}):this.setState({scale:t})}else this.state.lastScale!==this.state.scale&&this.setState({lastScale:this.state.scale},this.drawTimeRuler)}},{key:"render",value:function(){var t=this;if(this.state.error)return Object(a.jsx)("div",{className:"center badge-danger",children:"sorry the video length is too large - web browsers have limit for canvas size"});var e=this.state.scale,n=this.props.duration,i=-(this.props.currentTime-4)/n*100;return Object(a.jsxs)("div",{className:"advanced-timeline "+this.props.className,children:[Object(a.jsxs)("div",{className:"side-bar",children:[Object(a.jsx)(D,{className:"mb-1",onClick:this.zoomIn,disabled:!this.isZoomInValid(this.state.scale+10),iconClassName:"fas fa-search-plus"}),Object(a.jsx)("div",{className:"center scale-text",children:e}),Object(a.jsx)(D,{className:"mb-1",onClick:this.zoomOut,disabled:!this.isZoomOutValid(this.state.scale-10),iconClassName:"fas fa-search-minus"})]}),Object(a.jsxs)("div",{className:"advanced-timeline-wrapper",children:[Object(a.jsx)("div",{className:"current-time-cursor",style:{marginLeft:"".concat(4*e,"px")}}),Object(a.jsxs)("div",{className:"mover",style:{transform:"translateX(".concat(i,"%)"),width:"".concat(n*e,"px")},children:[Object(a.jsxs)("div",{className:"time-ruler-wrapper",children:[Object(a.jsx)("canvas",{className:"time-ruler",ref:this.canvasRef,width:n*e,height:"32"}),Object(a.jsx)(V,{onTimePick:this.setTimeFromPixels})]}),Object(a.jsx)("div",{className:"captions-side",children:this.props.captions.map((function(n,i){return function(t,e,n,i,s){var c=t.end-t.start;return Object(a.jsx)("div",{className:"caption-item "+(n===e?"selected":""),onClick:function(t){return i(e)},style:{left:"".concat(t.start*s,"px"),width:"".concat(c*s,"px")},children:Object(a.jsx)("span",{children:t.content})},t.hash)}(n,i,t.props.selectedCaption_i,t.captionSelectionHandler,e)}))})]})]})]})}}]),n}(s.a.Component));var V=function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(){var t;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(t=e.call.apply(e,[this].concat(i))).state={cursorXPos:0},t}return Object(l.a)(n,[{key:"calculateRealOffset",value:function(t){return t.pageX-t.currentTarget.getBoundingClientRect().left}},{key:"render",value:function(){var t=this;return Object(a.jsx)("div",{className:"user-time-cursor-wrapper",onMouseMove:function(e){return t.setState({cursorXPos:t.calculateRealOffset(e)})},onMouseLeave:function(){return t.setState({cursorXPos:0})},onClick:function(e){return t.props.onTimePick(t.calculateRealOffset(e))},children:Object(a.jsx)("div",{className:"user-time-cursor",style:{transform:"translateX(".concat(this.state.cursorXPos,"px)")}})})}}]),n}(s.a.Component),U=P,H=(n(49),function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).state={isEditing:!1,timeEditing:""},a.changeHandler=a.changeHandler.bind(Object(j.a)(a)),a.changeTimeEditing=a.changeTimeEditing.bind(Object(j.a)(a)),a.textEditorTimeChange=a.textEditorTimeChange.bind(Object(j.a)(a)),a}return Object(l.a)(n,[{key:"changeEditingState",value:function(t){this.props.onChange&&this.setState({isEditing:t,timeEditing:t?y(this.props.time,"complete"):""})}},{key:"textEditorTimeChange",value:function(t){var e,n=t.target.value;try{e=x(n)}catch(i){return}var a=e-this.props.time;this.changeHandler(a),this.changeEditingState(!1)}},{key:"changeTimeEditing",value:function(t){this.setState({timeEditing:t.target.value})}},{key:"changeHandler",value:function(t){this.props.onChange&&this.props.onChange(t)}},{key:"render",value:function(){var t=this,e=void 0===this.props.onChange,n=y(this.props.time,"complete"),i=this.state.isEditing?Object(a.jsx)("div",{className:"time-editor",children:Object(a.jsx)("input",{type:"text",className:"time-text-editor",onChange:this.changeTimeEditing,value:this.state.timeEditing,autoFocus:!0,onBlur:this.textEditorTimeChange})}):Object(a.jsx)("div",{className:"time-text",onDoubleClick:function(){return t.changeEditingState(!0)},children:Object(a.jsxs)("span",{children:[" ",n," "]})});return Object(a.jsxs)("div",{className:"time-control-wrapper",children:[Object(a.jsx)(D,{className:"time-control-btn minus-time",disabled:e,iconClassName:"fas fa-minus",onClick:function(){return t.changeHandler(-.5)}}),Object(a.jsx)(D,{className:"time-control-btn minus-time little",disabled:e,onClick:function(){return t.changeHandler(-.1)},iconClassName:"fas fa-minus"}),i,Object(a.jsx)(D,{className:"time-control-btn add-time little",disabled:e,onClick:function(){return t.changeHandler(.1)},iconClassName:"fas fa-plus"}),Object(a.jsx)(D,{className:"time-control-btn add-time",disabled:e,onClick:function(){return t.changeHandler(.5)},iconClassName:"fas fa-plus"}),Object(a.jsx)(D,{className:"time-control-btn add-time",disabled:e,onClick:function(){return t.changeHandler(null)},iconClassName:"fas fa-angle-double-up"})]})}}]),n}(s.a.Component)),I=(n(50),n(51)),M=function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).VideoPlayerRef=void 0,a.state={videoUrl:C.videoUrl.getData(),currentTime:0,totalTime:0,captions:[],selected_caption_i:null,historyCursor:-1,capsHistory:[]},a.VideoPlayerRef=s.a.createRef(),a.onTimeUpdate=a.onTimeUpdate.bind(Object(j.a)(a)),a.onVideoError=a.onVideoError.bind(Object(j.a)(a)),a.addCaption=a.addCaption.bind(Object(j.a)(a)),a.onChangeCaption=a.onChangeCaption.bind(Object(j.a)(a)),a.onCaptionDeleted=a.onCaptionDeleted.bind(Object(j.a)(a)),a.onCaptionSelected=a.onCaptionSelected.bind(Object(j.a)(a)),a.clearCaptions=a.clearCaptions.bind(Object(j.a)(a)),a.captureLastStates=a.captureLastStates.bind(Object(j.a)(a)),a.undo=a.undo.bind(Object(j.a)(a)),a.redo=a.redo.bind(Object(j.a)(a)),a.saveFile=a.saveFile.bind(Object(j.a)(a)),a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var t=this,e=C.subtitles.getData();this.setState({captions:e,capsHistory:[JSON.stringify(e)],historyCursor:0}),N.a.filter=function(){return!0},Object(N.a)("alt+*,tab",(function(t){t.preventDefault()})),Object(N.a)("ctrl+shift+left",(function(e){var n;null===t.state.selected_caption_i&&(e.preventDefault(),null===(n=t.VideoPlayerRef.current)||void 0===n||n.shootTime(-5))})),Object(N.a)("ctrl+shift+right",(function(e){var n;null===t.state.selected_caption_i&&(e.preventDefault(),null===(n=t.VideoPlayerRef.current)||void 0===n||n.shootTime(5))})),Object(N.a)("ctrl+left",(function(e){var n;null===t.state.selected_caption_i&&(e.preventDefault(),null===(n=t.VideoPlayerRef.current)||void 0===n||n.shootTime(-.5))})),Object(N.a)("ctrl+right",(function(e){var n;null===t.state.selected_caption_i&&(e.preventDefault(),null===(n=t.VideoPlayerRef.current)||void 0===n||n.shootTime(.5))})),Object(N.a)("ctrl+enter",this.addCaption),Object(N.a)("ctrl+down",(function(e){e.preventDefault();var n=t.state.currentTime,a=t.state.captions.findIndex((function(t){return n>=t.start&&n<=t.end}));-1!==a&&t.setState({selected_caption_i:a})})),Object(N.a)("escape",(function(e){e.preventDefault(),t.setState({selected_caption_i:null})})),Object(N.a)("space",(function(t){"INPUT"!==t.target.tagName&&t.preventDefault()})),Object(N.a)("ctrl+space",(function(e){var n;null===(n=t.VideoPlayerRef.current)||void 0===n||n.togglePlay()})),Object(N.a)("ctrl+delete",this.onCaptionDeleted),Object(N.a)("ctrl+z",this.undo),Object(N.a)("ctrl+y",this.redo),Object(N.a)("ctrl+s",(function(e){e.preventDefault(),t.saveFile()}))}},{key:"componentWillUnmount",value:function(){N.a.unbind()}},{key:"onTimeUpdate",value:function(t){var e=this.state.selected_caption_i;if(null!==e){var n,a,i,s=this.state.captions[e],c=this.VideoPlayerRef,o=null===(n=c.current)||void 0===n?void 0:n.isPlaying();if(t>=s.end){if(o)null===(a=c.current)||void 0===a||a.setPlay(!1),null===(i=c.current)||void 0===i||i.setTime(s.start)}else if(t<s.start){var r;o&&(null===(r=c.current)||void 0===r||r.setTime(s.start))}}this.setState({currentTime:t})}},{key:"onVideoError",value:function(t){alert("video load error")}},{key:"addCaption",value:function(){var t=this.state.captions;t.push({start:this.state.currentTime,end:this.state.currentTime+1,content:"New Caption",hash:Object(k.v4)()}),this.setState({captions:t,selected_caption_i:t.length-1},this.captureLastStates)}},{key:"onChangeCaption",value:function(t){var e,n,a=this.state.captions.findIndex((function(e){return e.hash===t.hash}));if(-1!==a&&(e=t,n=this.state.captions[a],e.start!==n.start||e.end!==n.end||e.content!==n.content)){t.hash=Object(k.v4)();var i=this.state.captions;i[a]=t,this.setState({captions:i},this.captureLastStates)}}},{key:"onCaptionDeleted",value:function(){if(null!==this.state.selected_caption_i){var t=this.state.captions;t.splice(this.state.selected_caption_i,1),this.setState({captions:t,selected_caption_i:null},this.captureLastStates)}}},{key:"onCaptionSelected",value:function(t){var e=this.state.selected_caption_i===t?null:t;this.setState({selected_caption_i:e})}},{key:"clearCaptions",value:function(){this.setState({captions:[],selected_caption_i:null},this.captureLastStates)}},{key:"captureLastStates",value:function(){var t=this.state.capsHistory;this.state.historyCursor!==t.length-1?t=t.slice(0,this.state.historyCursor+1):t.length>=5&&t.splice(0,1),t.push(JSON.stringify(this.state.captions)),this.setState({capsHistory:t,historyCursor:t.length-1})}},{key:"undo",value:function(){this.state.historyCursor>0&&this.setState((function(t){return{captions:JSON.parse(t.capsHistory[t.historyCursor-1]),historyCursor:t.historyCursor-1,selected_caption_i:null}}))}},{key:"redo",value:function(){this.state.historyCursor<this.state.capsHistory.length-1&&this.setState((function(t){return{captions:JSON.parse(t.capsHistory[t.historyCursor+1]),historyCursor:t.historyCursor+1,selected_caption_i:null}}))}},{key:"saveFile",value:function(){I(this.state.captions.map((function(t,e){return"".concat(e+1,"\n").concat(y(t.start,"complete")," --\x3e ").concat(y(t.end,"complete"),"\n").concat(t.content)})).join("\n\n"),"subtitle.srt")}},{key:"render",value:function(){var t=this;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h2",{className:"page-title",children:"Studio"}),Object(a.jsxs)("div",{className:"wrapper",children:[Object(a.jsx)("div",{className:"video-wrapper",children:Object(a.jsx)(E,{ref:this.VideoPlayerRef,videoUrl:this.state.videoUrl,onTimeUpdate:this.onTimeUpdate,onError:this.onVideoError,onDurationChanges:function(e){return t.setState({totalTime:e})}})}),Object(a.jsx)(R,{currentTime:this.state.currentTime,captions:this.state.captions}),Object(a.jsx)(_,{className:"my-2",currentTime:this.state.currentTime,totalTime:this.state.totalTime,onSelectNewTime:function(e){var n;return null===(n=t.VideoPlayerRef.current)||void 0===n?void 0:n.setTime(e)}}),Object(a.jsxs)("div",{className:"d-flex justify-content-center action-button-group my-2",children:[Object(a.jsx)(D,{iconClassName:"fas fa-plus",text:"add caption",onClick:this.addCaption}),Object(a.jsx)(D,{iconClassName:"fas fa-undo",disabled:0===this.state.historyCursor,text:"undo "+this.state.historyCursor,onClick:this.undo}),Object(a.jsx)(D,{iconClassName:"fas fa-redo",text:"redo "+(this.state.capsHistory.length-1-this.state.historyCursor),disabled:!(this.state.historyCursor+1<this.state.capsHistory.length),onClick:this.redo}),Object(a.jsx)(D,{iconClassName:"fas fa-times",disabled:null===this.state.selected_caption_i,text:"unselect",onClick:function(){return t.setState({selected_caption_i:null})}}),Object(a.jsx)(D,{iconClassName:"fas fa-trash",disabled:null===this.state.selected_caption_i,text:"delete",onClick:this.onCaptionDeleted}),Object(a.jsx)(D,{iconClassName:"fas fa-broom",text:"clear timeline",disabled:0===this.state.captions.length,onClick:this.clearCaptions})]}),Object(a.jsx)(U,{className:"my-1",duration:this.state.totalTime,currentTime:this.state.currentTime,onSelectNewTime:function(e){var n;return null===(n=t.VideoPlayerRef.current)||void 0===n?void 0:n.setTime(e)},captions:this.state.captions,onCaptionSelected:this.onCaptionSelected,selectedCaption_i:this.state.selected_caption_i}),Object(a.jsx)(w,{currentTime:this.state.currentTime,totalTime:this.state.totalTime,caption:null===this.state.selected_caption_i?null:this.state.captions[this.state.selected_caption_i],onCaptionChanged:this.onChangeCaption})]}),Object(a.jsx)("div",{className:"d-flex justify-content-center my-2",children:Object(a.jsx)("button",{className:"btn btn-danger",onClick:this.saveFile,children:Object(a.jsxs)("strong",{children:[" save as a file ",Object(a.jsx)("span",{className:"fas fa-file"}),"  "]})})})]})}}]),n}(s.a.Component),z=(n(52),function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(){var t;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(t=e.call.apply(e,[this].concat(i))).state={shortcuts:[{keys:["ctrl","enter"],clue:"play/pause video player"},{keys:["ctrl","right/left"],clue:"go forward/backward in timeline [small step]"},{keys:["ctrl","shift","right/left"],clue:"go forward/backward in timeline [big step]"},{keys:["ctrl","+/-"],clue:"zoom in/out in timeline"},{keys:["ctrl","shift","+/-"],clue:"zoom in/out web page"},{keys:["ctrl","down"],clue:"select current caption"},{keys:["escape"],clue:"unselect selected caption"},{keys:["tab","left/right"],clue:"shoot end of selected caption forward/backward"},{keys:["alt","left/right"],clue:"shoot start of selected caption forward/backward"},{keys:["ctrl","enter"],clue:"create new caption"},{keys:["ctrl","delete"],clue:"delete selected caption"},{keys:["ctrl","z/y"],clue:"undo/redo"},{keys:["ctrl","s"],clue:"save subtitle"}]},t}return Object(l.a)(n,[{key:"render",value:function(){return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h2",{className:"page-title",children:"Help"}),Object(a.jsx)("div",{className:"wrapper",children:this.state.shortcuts.map((function(t){return Object(a.jsxs)("div",{className:"shortcut d-flex justify-content-between",children:[Object(a.jsx)("span",{className:"keys",children:t.keys.map((function(t,e){return Object(a.jsxs)(a.Fragment,{children:[0!==e?Object(a.jsx)("span",{className:"plus",children:"+"}):"",Object(a.jsx)("code",{className:"key",children:t})]})}))}),Object(a.jsxs)("span",{className:"clue",children:[" ",t.clue," "]})]})}))})]})}}]),n}(s.a.Component)),F=(n(53),function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(){return Object(r.a)(this,n),e.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(a.jsxs)(h.a,{children:[Object(a.jsx)(p.b,{exact:!0,path:"/subtitle-edtior/",component:T}),Object(a.jsx)(p.b,{exact:!0,path:"/subtitle-edtior/studio",component:M}),Object(a.jsx)(p.b,{exact:!0,path:"/subtitle-edtior/help",component:z})]})}}]),n}(s.a.Component));o.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(F,{})}),document.getElementById("root"))}},[[54,1,2]]]);
//# sourceMappingURL=main.addab3a7.chunk.js.map