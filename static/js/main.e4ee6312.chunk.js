(this["webpackJsonpsubtitle-editor"]=this["webpackJsonpsubtitle-editor"]||[]).push([[0],{51:function(e,t,n){},52:function(e,t,n){},55:function(e,t,n){},67:function(e,t,n){},68:function(e,t,n){},69:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(6),s=n.n(i),o=n(26),c=n.n(o),r=n(2),l=n(3),d=n(5),u=n(4),h=n(27),p=n(11),b=n(32),j=n.n(b),m=n(43),f=n(7),v=(n(51),function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)("div",{className:"d-inline-block "+this.props.className,children:[Object(a.jsx)("button",{className:"btn circle-btn add-caption-btn "+(this.props.disabled?"disabled":""),onClick:this.props.onClick,children:Object(a.jsx)("span",{className:this.props.iconClassName})}),this.props.text?Object(a.jsx)("div",{className:"badge",children:Object(a.jsxs)("span",{children:[" ",this.props.text," "]})}):""]})})}}]),n}(s.a.Component)),O=(n(52),function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).fileInput=void 0,a.fileInput=Object(i.createRef)(),a.changeHandler=a.changeHandler.bind(Object(f.a)(a)),a.redirectToInput=a.redirectToInput.bind(Object(f.a)(a)),a}return Object(l.a)(n,[{key:"changeHandler",value:function(e){var t,n=e.target;if(this.props.onChange&&(null===(t=n.files)||void 0===t?void 0:t.length)){var a=n.files[0];this.props.onChange(a)}}},{key:"redirectToInput",value:function(){var e;null===(e=this.fileInput.current)||void 0===e||e.click()}},{key:"render",value:function(){var e=this,t=this.props.filename,n=t?"[".concat(t,"] click to rechoose"):"choose a file";return Object(a.jsxs)("div",{className:"form-group file-input-wrapper",children:[Object(a.jsx)("input",{type:"file",ref:this.fileInput,className:"d-none",onChange:this.changeHandler}),Object(a.jsx)("button",{className:"rounded font-weight-bold btn btn-info w-100 virtual-file-input",onClick:function(t){return e.redirectToInput()},children:Object(a.jsxs)("span",{children:[" ",n," "]})})]})}}]),n}(s.a.Component));function g(e){var t=new CustomEvent("toast",{detail:e});window.dispatchEvent(t)}var C=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={isOpen:!1,timerId:0,lastMessage:{kind:"success",message:"",duration:0}},a.disableToast=a.disableToast.bind(Object(f.a)(a)),a.cancelToast=a.cancelToast.bind(Object(f.a)(a)),a.cancelTimer=a.cancelTimer.bind(Object(f.a)(a)),a}return Object(l.a)(n,[{key:"cancelTimer",value:function(){this.state.timerId&&(clearTimeout(this.state.timerId),this.setState({timerId:0}))}},{key:"cancelToast",value:function(){this.cancelTimer(),console.log("errrrr"),this.setState({isOpen:!1})}},{key:"disableToast",value:function(e){this.cancelTimer(),this.setState({timerId:window.setTimeout(this.cancelToast,e)})}},{key:"componentDidMount",value:function(){var e=this;window.addEventListener("toast",(function(t){e.setState({lastMessage:t.detail,isOpen:!0}),e.disableToast(t.detail.duration)}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("toast")}},{key:"render",value:function(){var e=this.state;return Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)("div",{className:"fixed-bottom m-4 alert "+"alert-".concat(e.lastMessage.kind," ").concat(e.isOpen?"":"d-none"),children:[Object(a.jsx)("button",{className:"close",onClick:this.cancelToast,children:"\xd7"}),Object(a.jsx)("strong",{children:e.lastMessage.message})]})})}}]),n}(s.a.Component),x=function(){function e(t){Object(r.a)(this,e),this.data=void 0,this.data=t}return Object(l.a)(e,[{key:"getData",value:function(){return this.data}},{key:"setData",value:function(e){this.data=e}}]),e}(),y={videoUrl:new x(""),subtitles:new x([])};function k(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=1;n<=t;){var a=Math.pow(10,n);if(!(e>=a))break;n++}return"0".repeat(t-n)+String(e)}function T(e,t){var n=Math.floor(e%1*1e3),a=Math.floor(e%60),i=Math.floor(e%3600/60),s=Math.floor(e/3600);return"minute"===t?"".concat(k(i),":").concat(k(a)):"minute+ms"===t?"".concat(k(i),":").concat(k(a),".").concat(k(n,3)):"complete"===t?"".concat(k(s),":").concat(k(i),":").concat(k(a),",").concat(k(n,3)):""}function N(e){return 60*Number(e.slice(0,2))*60+60*Number(e.slice(3,5))+Number(e.slice(6,8))+Number(e.slice(9))/1e3}var w=n(19);function S(e,t){return e.start>t.start?1:t.start>e.start?-1:0}n(55);var R=n(33),D=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={subtitleUrl:"",videoUrl:"",canPass:!1,subtitleFname:"",videoFname:""},a.handler=a.handler.bind(Object(f.a)(a)),a.loadCaptions=a.loadCaptions.bind(Object(f.a)(a)),a.loadVideo=a.loadVideo.bind(Object(f.a)(a)),a.checkValidation=a.checkValidation.bind(Object(f.a)(a)),a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e,t,n=Object.fromEntries(new URLSearchParams(window.location.search).entries()),a=null!==(e=n.subtitle)&&void 0!==e?e:"",i=null!==(t=n.video)&&void 0!==t?t:"";this.loadVideo(i,Object(R.basename)(i)),this.loadCaptions(a,Object(R.basename)(a))}},{key:"loadCaptions",value:function(){var e=Object(m.a)(j.a.mark((function e(t,n){var a,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,fetch(t);case 4:return a=e.sent,e.next=7,a.text();case 7:i=e.sent,y.subtitles.setData((s=i,Array.from(s.matchAll(/[0-9]+\n([,0-:]{12}) \x2D\x2D> ([,0-:]{12})\n([\s\S]+?)(?=[0-9]+\n[,0-:]{12}|$)/g)).map((function(e){return{start:N(e[1]),end:N(e[2]),content:e[3].trim(),hash:Object(w.v4)()}})))),this.setState({subtitleUrl:t,subtitleFname:n});case 10:case"end":return e.stop()}var s}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadVideo",value:function(e,t){y.videoUrl.setData(e),this.setState({videoUrl:e,videoFname:t})}},{key:"handler",value:function(e,t){var n=URL.createObjectURL(e);"video"===t?this.loadVideo(n,e.name):this.loadCaptions(n,e.name)}},{key:"checkValidation",value:function(){this.state.videoUrl?this.setState({canPass:!0}):g({kind:"danger",message:"select a video first",duration:5e3})}},{key:"render",value:function(){var e=this;return this.state.canPass?Object(a.jsx)(p.a,{to:"/studio"}):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h2",{className:"page-title",children:" Intro "}),Object(a.jsxs)("div",{className:"wrapper",children:[Object(a.jsxs)("div",{className:"alert alert-secondary",children:["consider",Object(a.jsx)(h.b,{to:"/help",children:" help page "}),"for learning app features & shortcuts"]}),Object(a.jsxs)("div",{children:[Object(a.jsx)("span",{children:" video file: "}),Object(a.jsx)(O,{onChange:function(t){return e.handler(t,"video")},filename:this.state.videoFname})]}),Object(a.jsxs)("div",{className:"alert alert-info",children:["you can check supported video formats",Object(a.jsx)("a",{href:"https://en.wikipedia.org/wiki/HTML5_video",target:"blank",children:" here "})]}),Object(a.jsxs)("div",{className:"mt-3",children:[Object(a.jsx)("span",{children:" subtitle file: "}),Object(a.jsx)(O,{onChange:function(t){return e.handler(t,"subtitle")},filename:this.state.subtitleFname})]}),Object(a.jsx)("div",{className:"alert alert-warning",children:"if you don't select a subtitle file, we make new one"}),Object(a.jsx)("div",{className:"center",children:Object(a.jsx)("button",{className:"btn btn-success font-weight-bold",onClick:this.checkValidation,children:"go to studio!"})})]}),Object(a.jsx)("footer",{className:"p-2 w-100 d-flex justify-content-center",children:Object(a.jsxs)("a",{href:"https://github.com/hamidb80/subtitle-editor/",target:"blank",className:"d-flex align-items-center",children:[Object(a.jsx)("span",{className:"fab fa-github github-logo"}),Object(a.jsx)("span",{className:"pb-1 mx-2",children:" project link on github "})]})})]})}}]),n}(s.a.Component),E=n(22),_=n(10),I=n(8),H=n(21),U=n.n(H),V=n(9),P=function(e,t){return e>t?1:-1},M=(n(67),function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).inputRef=void 0,a.state={lastCaption:null,newCaption:null,is_ltr:!0},a.inputRef=s.a.createRef(),a.onCaptionContentChanged=a.onCaptionContentChanged.bind(Object(f.a)(a)),a.onCaptionTimeRangeChanged=a.onCaptionTimeRangeChanged.bind(Object(f.a)(a)),a.handleCaptionChange=a.handleCaptionChange.bind(Object(f.a)(a)),a.isCapInTimeRange=a.isCapInTimeRange.bind(Object(f.a)(a)),a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;Object(V.a)("alt+left",(function(){e.onCaptionTimeRangeChanged(-.5,0)})),Object(V.a)("ctrl+8",(function(t){t.preventDefault(),e.onCaptionTimeRangeChanged(null,0)})),Object(V.a)("ctrl+9",(function(t){t.preventDefault(),e.onCaptionTimeRangeChanged(0,null)})),Object(V.a)("ctrl+0",(function(t){t.preventDefault(),e.setState({is_ltr:!e.state.is_ltr})})),Object(V.a)("enter",(function(t){e.onCaptionContentChanged(t),e.handleCaptionChange()})),Object(V.a)("alt+right",(function(){e.onCaptionTimeRangeChanged(.5,0)})),Object(V.a)("tab+left",(function(t){t.preventDefault(),e.onCaptionTimeRangeChanged(0,-.5)})),Object(V.a)("tab+right",(function(t){t.preventDefault(),e.onCaptionTimeRangeChanged(0,.5)}))}},{key:"componentDidUpdate",value:function(){var e;if(!this.props.caption&&this.state.lastCaption||this.props.caption&&this.props.caption.hash!==(null===(e=this.state.lastCaption)||void 0===e?void 0:e.hash)){this.handleCaptionChange();var t=null===this.props.caption?null:Object(_.a)({},this.props.caption);this.setState({lastCaption:t?Object(_.a)({},t):null,newCaption:t?Object(_.a)({},t):null})}}},{key:"isCapInTimeRange",value:function(e){return e>=0&&e<=this.props.totalTime}},{key:"onCaptionContentChanged",value:function(e){var t,n=this.state.newCaption;null!==n&&this.setState({newCaption:Object(_.a)(Object(_.a)({},n),{},{content:(null===(t=this.inputRef.current)||void 0===t?void 0:t.value)||""})})}},{key:"onCaptionTimeRangeChanged",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.state.newCaption;null!==n&&(null===e?n.start=this.props.currentTime+.001:this.isCapInTimeRange(n.start+e)&&(n.start+=e),null===t?n.end=this.props.currentTime:this.isCapInTimeRange(n.end+t)&&(n.end+=t),n.start>n.end&&(0===t?n.end=n.start:n.start=n.end),this.setState({newCaption:n},this.handleCaptionChange))}},{key:"handleCaptionChange",value:function(){var e,t,n=this;if(null!==this.state.lastCaption&&null!==this.state.newCaption&&(e=this.state.lastCaption,t=this.state.newCaption,e.start!==t.start||e.end!==t.end||e.content!==t.content)){this.state.lastCaption;var a=Object(_.a)(Object(_.a)({},this.state.newCaption),{},{hash:Object(w.v4)()});this.setState({lastCaption:Object(_.a)({},a),newCaption:Object(_.a)({},a)},(function(){return n.props.onCaptionChanged(n.props.captionIndex,a)}))}}},{key:"render",value:function(){var e,t,n,i=this,s=this.props.caption;return s?null===(e=this.inputRef.current)||void 0===e||e.focus():null===(t=this.inputRef.current)||void 0===t||t.blur(),Object(a.jsxs)("div",{className:"caption-editor-wrapper",children:[s?Object(a.jsx)(W,{time:s.start,onChange:function(e){i.onCaptionTimeRangeChanged(e,0)}}):Object(a.jsx)(W,{time:0}),Object(a.jsxs)("div",{children:[Object(a.jsx)(v,{disabled:null===s,onClick:function(){return i.setState((function(e){return{is_ltr:!e.is_ltr}}))},iconClassName:"fas fa-align-"+(this.state.is_ltr?"left":"right")}),Object(a.jsx)("input",{type:"text",ref:this.inputRef,disabled:null===s,className:"form-control caption-editor "+(this.state.is_ltr?"ltr":"rtl"),value:(null===(n=this.state.newCaption)||void 0===n?void 0:n.content)||"",onChange:this.onCaptionContentChanged,onBlur:this.handleCaptionChange})]}),s?Object(a.jsx)(W,{time:s.end,onChange:function(e){i.onCaptionTimeRangeChanged(0,e)}}):Object(a.jsx)(W,{time:0})]})}}]),n}(s.a.Component)),F=(n(68),function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).getCaptionContent=a.getCaptionContent.bind(Object(f.a)(a)),a}return Object(l.a)(n,[{key:"getCaptionContent",value:function(){var e=this.props.currentTime,t=this.props.captions.find((function(t){return e>=t.start&&e<=t.end}));return t?t.content:""}},{key:"render",value:function(){var e=this.getCaptionContent();return Object(a.jsx)("div",{className:"caption-group",children:""===e?"":Object(a.jsx)("div",{className:"caption",children:e})})}}]),n}(s.a.Component)),z=(n(69),function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).handleClick=a.handleClick.bind(Object(f.a)(a)),a}return Object(l.a)(n,[{key:"handleClick",value:function(e){var t=this.props.onSelectNewTime;if(t){var n=e.currentTarget;t((e.pageX-n.offsetLeft)/n.clientWidth*this.props.totalTime)}}},{key:"render",value:function(){if(void 0===this.props.totalTime)return"";var e=this.props.currentTime/this.props.totalTime*100,t=T(this.props.currentTime,"minute"),n=T(this.props.totalTime,"minute");return Object(a.jsxs)("div",{className:"timeline "+this.props.className,onClick:this.handleClick,children:[Object(a.jsxs)("div",{className:"progress",children:[Object(a.jsx)("div",{className:"progress-bar",style:{width:"".concat(e,"%")}}),Object(a.jsx)("div",{className:"cursor"})]}),Object(a.jsx)("div",{className:"time-text-wrapper",children:Object(a.jsxs)("div",{className:"time-text",children:[Object(a.jsxs)("span",{children:[" ",t," "]}),Object(a.jsx)("span",{children:" - "}),Object(a.jsxs)("span",{children:[" ",n," "]})]})})]})}}]),n}(s.a.Component)),L=(n(70),function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).videoElementRef=void 0,a.timer=0,a.state=void 0,a.state={lastStart:0,showVideoControll:!1},a.videoElementRef=s.a.createRef(),a.onTimeUpdate=a.onTimeUpdate.bind(Object(f.a)(a)),a.onMouseMove=a.onMouseMove.bind(Object(f.a)(a)),a.onError=a.onError.bind(Object(f.a)(a)),a.setPlay=a.setPlay.bind(Object(f.a)(a)),a.isPlaying=a.isPlaying.bind(Object(f.a)(a)),a.disableVideoControllers=a.disableVideoControllers.bind(Object(f.a)(a)),a.onDurationChanges=a.onDurationChanges.bind(Object(f.a)(a)),a}return Object(l.a)(n,[{key:"onDurationChanges",value:function(){if(this.props.onDurationChanges){var e,t=(null===(e=this.videoElementRef.current)||void 0===e?void 0:e.duration)||0;this.props.onDurationChanges(t)}}},{key:"onTimeUpdate",value:function(e){if(this.props.onTimeUpdate){var t=e.currentTarget.currentTime;this.props.onTimeUpdate(t)}}},{key:"onMouseMove",value:function(e){this.timer&&clearTimeout(this.timer),this.setState({showVideoControll:!0}),this.timer=+setTimeout(this.disableVideoControllers,2e3)}},{key:"onError",value:function(e){this.props.onError&&this.props.onError(e)}},{key:"disableVideoControllers",value:function(){clearTimeout(this.timer),this.setState({showVideoControll:!1})}},{key:"setTime",value:function(e){var t=this.videoElementRef.current;t&&(t.currentTime=e)}},{key:"shootTime",value:function(e){var t=this.videoElementRef.current;if(t){var n=t.currentTime;this.setTime(n+e)}}},{key:"setPlay",value:function(e){var t,n;this.videoElementRef.current&&(e?null===(t=this.videoElementRef.current)||void 0===t||t.play():null===(n=this.videoElementRef.current)||void 0===n||n.pause())}},{key:"togglePlay",value:function(){this.setPlay(!this.isPlaying())}},{key:"isPlaying",value:function(){return Boolean(this.videoElementRef.current&&!this.videoElementRef.current.paused)}},{key:"render",value:function(){var e=this,t=this.isPlaying();return Object(a.jsx)("div",{className:"video-player "+(this.state.showVideoControll?"show ":""),onMouseMove:this.onMouseMove,onMouseOut:this.disableVideoControllers,children:Object(a.jsxs)("div",{className:"video-screen",onContextMenu:function(e){return e.preventDefault()},children:[Object(a.jsx)("video",{height:this.props.height,onTimeUpdate:this.onTimeUpdate,ref:this.videoElementRef,src:this.props.videoUrl,autoPlay:!1,loop:!1,onDurationChange:this.onDurationChanges,onError:function(t){return e.onError(t)}}),Object(a.jsxs)("div",{className:"video-state-controller",children:[Object(a.jsx)("div",{className:"part"}),Object(a.jsx)("div",{className:"part action-btn-group",children:Object(a.jsx)("div",{className:"action-btn play-pause",onClick:function(){return e.setPlay(!t)},children:Object(a.jsx)("span",{className:"icon fas fa-3x "+(t?"fa-pause":"fa-play")})})}),Object(a.jsx)("div",{className:"part"})]})]})})}}]),n}(s.a.Component)),X=n(17),Z=(n(71),function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).canvasRef=void 0,a.group=void 0,a.state={error:!1,lastScale:0,scale:0,cursorXPos:-10,timeRulers:[]},a.canvasRef=s.a.createRef(),a.group=null,a.captionSelectionHandler=a.captionSelectionHandler.bind(Object(f.a)(a)),a.onBackgroundClick=a.onBackgroundClick.bind(Object(f.a)(a)),a.initTimeRuler=a.initTimeRuler.bind(Object(f.a)(a)),a.updateRuler=a.updateRuler.bind(Object(f.a)(a)),a.setTimeFromPixels=a.setTimeFromPixels.bind(Object(f.a)(a)),a.zoom=a.zoom.bind(Object(f.a)(a)),a.zoomIn=a.zoomIn.bind(Object(f.a)(a)),a.zoomOut=a.zoomOut.bind(Object(f.a)(a)),a.isZoomInValid=a.isZoomInValid.bind(Object(f.a)(a)),a.isZoomOutValid=a.isZoomOutValid.bind(Object(f.a)(a)),a.calculateRealOffset=a.calculateRealOffset.bind(Object(f.a)(a)),a}return Object(l.a)(n,[{key:"captionSelectionHandler",value:function(e){this.props.onCaptionSelected(e)}},{key:"onBackgroundClick",value:function(){console.log("wow"),this.props.onCaptionSelected(null)}},{key:"zoom",value:function(e){var t=this.state.scale+e;this.isZoomInValid(t)&&this.isZoomOutValid(t)&&this.setState({scale:t})}},{key:"isZoomInValid",value:function(e){return e<=100}},{key:"isZoomOutValid",value:function(e){return e>0}},{key:"zoomIn",value:function(){this.zoom(10)}},{key:"zoomOut",value:function(){this.zoom(-10)}},{key:"calculateRealOffset",value:function(e){return e.pageX-e.currentTarget.getBoundingClientRect().left}},{key:"setTimeFromPixels",value:function(e){this.props.onSelectNewTime(this.props.currentTime-4+e/this.state.scale)}},{key:"initTimeRuler",value:function(){var e=new X.a.Stage({container:this.canvasRef.current,width:window.innerWidth,height:32}),t=new X.a.Layer;this.group=new X.a.Group,t.add(this.group),e.add(t),this.updateRuler()}},{key:"updateRuler",value:function(){for(var e=[],t=this.state.scale,n=Math.floor(32e3/t),a=this.props.duration,i=0;i<a;){for(var s,o,c=Math.min(a,i+n),r=i;r<=c;r++){var l,d,u={text:T(r,"minute"),x:this.state.scale*r-14,y:4,fontSize:13,fontFamily:"tahoma"};if(t<20)r%5===0&&(null===(d=this.group)||void 0===d||d.add(new X.a.Text(u)));else if(t<30){var h;r%3===0&&(null===(h=this.group)||void 0===h||h.add(new X.a.Text(u)))}else if(t<40){var p;r%2===0&&(null===(p=this.group)||void 0===p||p.add(new X.a.Text(u)))}else{var b;null===(b=this.group)||void 0===b||b.add(new X.a.Text(u))}null===(l=this.group)||void 0===l||l.add(new X.a.Rect({x:t*r,y:22,width:2,height:10,fill:"black"}))}e.push(null===(s=this.group)||void 0===s?void 0:s.toDataURL()),null===(o=this.group)||void 0===o||o.destroyChildren(),i=c}this.setState({timeRulers:e})}},{key:"componentDidMount",value:function(){var e=this;Object(V.a)("ctrl+=",(function(t){t.preventDefault(),e.zoomIn()})),Object(V.a)("ctrl+-",(function(t){t.preventDefault(),e.zoomOut()}))}},{key:"componentDidUpdate",value:function(){if(0!==this.props.duration){if(0===this.state.scale){this.setState({scale:30})}else this.state.lastScale!==this.state.scale&&this.setState({lastScale:this.state.scale},this.updateRuler);null===this.group&&this.initTimeRuler()}}},{key:"render",value:function(){var e=this;if(this.state.error)return Object(a.jsx)("div",{className:"center badge-danger",children:" an error acuured "});var t=this.props.duration,n=-(this.props.currentTime-4)/t*100,i=this.state.scale;return Object(a.jsxs)("div",{className:"advanced-timeline "+this.props.className,children:[Object(a.jsxs)("div",{className:"side-bar",children:[Object(a.jsx)(v,{className:"mb-1",onClick:this.zoomIn,disabled:!this.isZoomInValid(this.state.scale+10),iconClassName:"fas fa-search-plus"}),Object(a.jsx)("div",{className:"center scale-text",children:i}),Object(a.jsx)(v,{className:"mb-1",onClick:this.zoomOut,disabled:!this.isZoomOutValid(this.state.scale-10),iconClassName:"fas fa-search-minus"})]}),Object(a.jsxs)("div",{className:"advanced-timeline-wrapper",children:[Object(a.jsx)("div",{className:"current-time-cursor",style:{marginLeft:"".concat(4*i,"px")}}),Object(a.jsxs)("div",{className:"mover",onMouseMove:function(t){return e.setState({cursorXPos:e.calculateRealOffset(t)})},onMouseLeave:function(){return e.setState({cursorXPos:-10})},children:[Object(a.jsx)("div",{className:"konva-instance",ref:this.canvasRef}),Object(a.jsx)("div",{className:"time-cursor-wrapper",children:Object(a.jsx)(A,{posx:this.state.cursorXPos,onclick:function(t){return e.setTimeFromPixels(e.calculateRealOffset(t))}})}),Object(a.jsxs)("div",{className:"inside-timeline",style:{transform:"translateX(".concat(n,"%)"),width:"".concat(t*i,"px"),transition:"0.1s linear"},children:[Object(a.jsx)("div",{className:"times",children:this.state.timeRulers.map((function(e,t){return Object(a.jsx)("img",{src:e,alt:"time-ruler-{i}"})}))}),Object(a.jsx)("div",{className:"captions-side",onClick:this.onBackgroundClick,children:this.props.captions.map((function(t,n){var s;return Object(a.jsx)(B,{cap:t,index:n,selected_i:null!==(s=e.props.selectedCaption_i)&&void 0!==s?s:-1,clickFunc:e.captionSelectionHandler,onCaptionChanged:e.props.onCaptionChanged,scale:i})}))})]})]})]})]})}}]),n}(s.a.Component)),B=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={cachedCap:e.cap},a.onClick=a.onClick.bind(Object(f.a)(a)),a.onDragCenterStop=a.onDragCenterStop.bind(Object(f.a)(a)),a.onDragHeadStop=a.onDragHeadStop.bind(Object(f.a)(a)),a.onDragTailStop=a.onDragTailStop.bind(Object(f.a)(a)),a}return Object(l.a)(n,[{key:"onDragCenterStop",value:function(e,t){if(this.props.selected_i===this.props.index){var n=this.props.cap,a=this.props.scale,i=Object(_.a)(Object(_.a)({},n),{},{start:n.start+t.lastX/a,end:n.end+t.lastX/a});this.props.onCaptionChanged(this.props.selected_i,i)}}},{key:"onDragHeadStop",value:function(e,t){if(this.props.selected_i===this.props.index){var n=this.props.cap,a=this.props.scale,i=Object(_.a)(Object(_.a)({},n),{},{start:n.start+t.lastX/a});this.props.onCaptionChanged(this.props.selected_i,i)}}},{key:"onDragTailStop",value:function(e,t){if(this.props.selected_i===this.props.index){var n=this.props.cap,a=this.props.scale,i=Object(_.a)(Object(_.a)({},n),{},{end:n.end+t.lastX/a});this.props.onCaptionChanged(this.props.selected_i,i)}}},{key:"onClick",value:function(e){e.stopPropagation(),this.props.clickFunc(this.props.index)}},{key:"render",value:function(){var e=this.props.cap,t=e.end-e.start,n=this.props.selected_i===this.props.index;return Object(a.jsxs)("div",{className:"caption-item "+(n?"selected":""),onClick:this.onClick,style:{left:"".concat(e.start*this.props.scale,"px"),width:"".concat(t*this.props.scale,"px")},children:[Object(a.jsx)("div",{className:"start-pad",children:Object(a.jsx)(U.a,{axis:n?"x":"none",position:{x:0,y:0},onStop:this.onDragHeadStop,children:Object(a.jsx)("div",{className:"inside"})})}),Object(a.jsxs)("div",{className:"content",children:[Object(a.jsx)(U.a,{axis:n?"x":"none",position:{x:0,y:0},onStop:this.onDragCenterStop,children:Object(a.jsx)("div",{className:"slide"})}),Object(a.jsx)("span",{children:e.content})]}),Object(a.jsx)("div",{className:"end-pad",children:Object(a.jsx)(U.a,{axis:n?"x":"none",position:{x:0,y:0},onStop:this.onDragTailStop,children:Object(a.jsx)("div",{className:"inside"})})})]},e.hash)}}]),n}(s.a.Component),A=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(a.jsx)("div",{className:"user-time-cursor-wrapper",onClick:this.props.onclick,children:Object(a.jsx)("div",{className:"user-time-cursor",style:{transform:"translateX(".concat(this.props.posx,"px)")}})})}}]),n}(s.a.Component),W=(n(72),function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={isEditing:!1,timeEditing:""},a.changeHandler=a.changeHandler.bind(Object(f.a)(a)),a.changeTimeEditing=a.changeTimeEditing.bind(Object(f.a)(a)),a.textEditorTimeChange=a.textEditorTimeChange.bind(Object(f.a)(a)),a}return Object(l.a)(n,[{key:"changeEditingState",value:function(e){this.props.onChange&&this.setState({isEditing:e,timeEditing:e?T(this.props.time,"complete"):""})}},{key:"textEditorTimeChange",value:function(e){var t,n=e.target.value;try{t=N(n)}catch(i){return}var a=t-this.props.time;this.changeHandler(a),this.changeEditingState(!1)}},{key:"changeTimeEditing",value:function(e){this.setState({timeEditing:e.target.value})}},{key:"changeHandler",value:function(e){this.props.onChange&&this.props.onChange(e)}},{key:"render",value:function(){var e=this,t=void 0===this.props.onChange,n=T(this.props.time,"complete"),i=this.state.isEditing?Object(a.jsx)("div",{className:"time-editor",children:Object(a.jsx)("input",{type:"text",className:"time-text-editor",onChange:this.changeTimeEditing,value:this.state.timeEditing,autoFocus:!0,onBlur:this.textEditorTimeChange})}):Object(a.jsx)("div",{className:"time-text",onDoubleClick:function(){return e.changeEditingState(!0)},children:Object(a.jsxs)("span",{children:[" ",n," "]})});return Object(a.jsxs)("div",{className:"time-control-wrapper",children:[Object(a.jsx)(v,{className:"time-control-btn minus-time",disabled:t,iconClassName:"fas fa-minus",onClick:function(){return e.changeHandler(-.5)}}),Object(a.jsx)(v,{className:"time-control-btn minus-time little",disabled:t,onClick:function(){return e.changeHandler(-.1)},iconClassName:"fas fa-minus"}),i,Object(a.jsx)(v,{className:"time-control-btn add-time little",disabled:t,onClick:function(){return e.changeHandler(.1)},iconClassName:"fas fa-plus"}),Object(a.jsx)(v,{className:"time-control-btn add-time",disabled:t,onClick:function(){return e.changeHandler(.5)},iconClassName:"fas fa-plus"}),Object(a.jsx)(v,{className:"time-control-btn add-time",disabled:t,onClick:function(){return e.changeHandler(null)},iconClassName:"fas fa-angle-double-up"})]})}}]),n}(s.a.Component)),G=(n(73),n(74));var J=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).VideoPlayerRef=void 0,a.state={videoUrl:y.videoUrl.getData(),videoHeight:400,acc:0,currentTime:0,totalTime:0,subFileName:"subtitle.srt",captions:[],selected_caption_i:null,historyCursor:-1,history:[]},a.VideoPlayerRef=s.a.createRef(),a.onTimeUpdate=a.onTimeUpdate.bind(Object(f.a)(a)),a.onVideoError=a.onVideoError.bind(Object(f.a)(a)),a.handleSeparatorDrag=a.handleSeparatorDrag.bind(Object(f.a)(a)),a.handleSeparatorStop=a.handleSeparatorStop.bind(Object(f.a)(a)),a.addCaptionUIHandler=a.addCaptionUIHandler.bind(Object(f.a)(a)),a.changeCaptionUIHandler=a.changeCaptionUIHandler.bind(Object(f.a)(a)),a.changeCaptionObject=a.changeCaptionObject.bind(Object(f.a)(a)),a.deleteCaptionUIHandler=a.deleteCaptionUIHandler.bind(Object(f.a)(a)),a.deleteCaptionObject=a.deleteCaptionObject.bind(Object(f.a)(a)),a.captionSelectionToggle=a.captionSelectionToggle.bind(Object(f.a)(a)),a.updatedHistory=a.updatedHistory.bind(Object(f.a)(a)),a.undoRedo=a.undoRedo.bind(Object(f.a)(a)),a.goToLastStart=a.goToLastStart.bind(Object(f.a)(a)),a.goToNextEnd=a.goToNextEnd.bind(Object(f.a)(a)),a.saveFile=a.saveFile.bind(Object(f.a)(a)),a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=y.subtitles.getData();this.setState(Object(_.a)({captions:t},this.updatedHistory(t))),V.a.filter=function(){return!0},Object(V.a)("alt+*, tab, shift+tab",(function(e){return e.preventDefault()})),Object(V.a)("ctrl+shift+left",(function(t){var n;null===e.state.selected_caption_i&&(t.preventDefault(),null===(n=e.VideoPlayerRef.current)||void 0===n||n.shootTime(-5))})),Object(V.a)("ctrl+shift+right",(function(t){var n;null===e.state.selected_caption_i&&(t.preventDefault(),null===(n=e.VideoPlayerRef.current)||void 0===n||n.shootTime(5))})),Object(V.a)("ctrl+6",(function(t){t.preventDefault(),e.goToLastStart()})),Object(V.a)("ctrl+7",(function(t){t.preventDefault(),e.goToNextEnd()})),Object(V.a)("ctrl+left",(function(t){var n;t.preventDefault(),null===(n=e.VideoPlayerRef.current)||void 0===n||n.shootTime(-.5)})),Object(V.a)("ctrl+right",(function(t){var n;t.preventDefault(),null===(n=e.VideoPlayerRef.current)||void 0===n||n.shootTime(.5)})),Object(V.a)("ctrl+enter",(function(){return e.addCaptionUIHandler()})),Object(V.a)("ctrl+down",(function(t){t.preventDefault();var n=e.state.currentTime,a=e.state.captions.findIndex((function(e){return n>=e.start&&n<=e.end}));-1!==a&&e.setState({selected_caption_i:a})})),Object(V.a)("escape",(function(t){t.preventDefault(),e.setState({selected_caption_i:null})})),Object(V.a)("space",(function(e){"INPUT"!==e.target.tagName&&e.preventDefault()})),Object(V.a)("ctrl+space",(function(t){var n;null===(n=e.VideoPlayerRef.current)||void 0===n||n.togglePlay()})),Object(V.a)("ctrl+delete",(function(){return e.deleteCaptionUIHandler()})),Object(V.a)("ctrl+z",(function(){return e.undoRedo(!0)})),Object(V.a)("ctrl+y",(function(){return e.undoRedo(!1)})),Object(V.a)("ctrl+s",(function(t){t.preventDefault(),e.saveFile()}))}},{key:"componentWillUnmount",value:function(){V.a.unbind()}},{key:"onTimeUpdate",value:function(e){var t=this.state.selected_caption_i;if(null!==t){var n,a,i,s=this.state.captions[t],o=this.VideoPlayerRef,c=null===(n=o.current)||void 0===n?void 0:n.isPlaying();if(e>=s.end){if(c)null===(a=o.current)||void 0===a||a.setPlay(!1),null===(i=o.current)||void 0===i||i.setTime(s.start)}else if(e<s.start){var r;c&&(null===(r=o.current)||void 0===r||r.setTime(s.start))}}this.setState({currentTime:e})}},{key:"onVideoError",value:function(e){g({kind:"danger",message:"error happend while loading video",duration:5e3})}},{key:"changeCaptionObject",value:function(e,t){return n=this.state.captions,a=e,i=Object(_.a)(Object(_.a)({},t),{},{hash:Object(w.v4)()}),Object.assign([],n,Object(I.a)({},a,i));var n,a,i}},{key:"deleteCaptionObject",value:function(e){var t=Object(E.a)(this.state.captions),n=t.length-1;return e!=n&&(t[e]=t[n]),t.pop(),t}},{key:"addCaptionUIHandler",value:function(){var e=this.state.currentTime,t=this.state.captions.find((function(t){return e>=t.start&&e<=t.end})),n=t&&t.end-e<.6?t.end+.001:e,a={start:n,end:n+1,content:"New Caption",hash:Object(w.v4)()},i=this.state.captions.concat(a);this.setState(Object(_.a)({captions:i,selected_caption_i:this.state.captions.length},this.updatedHistory(i)))}},{key:"changeCaptionUIHandler",value:function(e,t){if(!(e<0||e>=this.state.captions.length)){var n=this.changeCaptionObject(e,t);this.setState(Object(_.a)({captions:n},this.updatedHistory(n)))}}},{key:"deleteCaptionUIHandler",value:function(){if(null!==this.state.selected_caption_i){var e=this.deleteCaptionObject(this.state.selected_caption_i);this.setState(Object(_.a)({selected_caption_i:null,captions:e},this.updatedHistory(e)))}}},{key:"updatedHistory",value:function(e){var t=this.state.history,n=t.length-1,a=this.state.historyCursor;return{historyCursor:(t=(t=[].concat(a<n?Object(E.a)(t.slice(0,a+1)):Object(E.a)(t),[e])).slice(-50)).length-1,history:t}}},{key:"undoRedo",value:function(e){var t=this.state.historyCursor,n=this.state.history,a=e?-1:1;t+a<-1||t+a>=n.length||this.setState({selected_caption_i:null,captions:this.state.history[t+(e?0:1)],historyCursor:t+a})}},{key:"captionSelectionToggle",value:function(e){this.setState({selected_caption_i:this.state.selected_caption_i===e?null:e})}},{key:"goToNextEnd",value:function(){var e,t=this.state,n=t.captions.filter((function(e){return t.currentTime<e.end})).map((function(e){return e.end})).sort(P);n.length&&(null===(e=this.VideoPlayerRef.current)||void 0===e||e.setTime(n[0]))}},{key:"goToLastStart",value:function(){var e,t=this.state,n=t.captions.filter((function(e){return t.currentTime>e.start})).map((function(e){return e.start})).sort(P);n.length&&(null===(e=this.VideoPlayerRef.current)||void 0===e||e.setTime(n[n.length-1]))}},{key:"saveFile",value:function(){this.state.captions.sort(S),G(this.state.captions.map((function(e,t){return"".concat(t+1,"\n").concat(T(e.start,"complete")," --\x3e ").concat(T(e.end,"complete"),"\n").concat(e.content)})).join("\n\n"),this.state.subFileName)}},{key:"handleSeparatorStop",value:function(e,t){this.setState({videoHeight:this.state.videoHeight+this.state.acc,acc:0})}},{key:"handleSeparatorDrag",value:function(e,t){this.setState({acc:this.state.acc+t.deltaY})}},{key:"render",value:function(){var e=this,t=this.state.captions,n=this.state.selected_caption_i;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h2",{className:"page-title",children:"Studio"}),Object(a.jsxs)("div",{className:"wrapper",children:[Object(a.jsx)("div",{className:"video-wrapper",children:Object(a.jsx)(L,{ref:this.VideoPlayerRef,videoUrl:this.state.videoUrl,onTimeUpdate:this.onTimeUpdate,onError:this.onVideoError,height:this.state.videoHeight,onDurationChanges:function(t){return e.setState({totalTime:t})}})}),Object(a.jsx)(U.a,{axis:"y",position:{x:0,y:0},onDrag:this.handleSeparatorDrag,onStop:this.handleSeparatorStop,children:Object(a.jsx)("div",{className:"separator mt-3"})}),Object(a.jsx)(F,{currentTime:this.state.currentTime,captions:t}),Object(a.jsx)(z,{className:"my-2",currentTime:this.state.currentTime,totalTime:this.state.totalTime,onSelectNewTime:function(t){var n;return null===(n=e.VideoPlayerRef.current)||void 0===n?void 0:n.setTime(t)}}),Object(a.jsxs)("div",{className:"d-flex justify-content-center action-button-group my-2",children:[Object(a.jsx)(v,{iconClassName:"fas fa-plus",text:"add caption",onClick:this.addCaptionUIHandler}),Object(a.jsx)(v,{iconClassName:"fas fa-undo",disabled:-1===this.state.historyCursor,text:"undo "+(this.state.historyCursor+1),onClick:function(){return e.undoRedo(!0)}}),Object(a.jsx)(v,{iconClassName:"fas fa-redo",text:"redo "+(this.state.history.length-1-this.state.historyCursor),disabled:this.state.historyCursor>=this.state.history.length-1,onClick:function(){return e.undoRedo(!1)}}),Object(a.jsx)(v,{iconClassName:"fas fa-times",disabled:null===this.state.selected_caption_i,text:"unselect",onClick:function(){return e.setState({selected_caption_i:null})}}),Object(a.jsx)(v,{iconClassName:"fas fa-trash",disabled:null===this.state.selected_caption_i,text:"delete",onClick:this.deleteCaptionUIHandler}),Object(a.jsx)(v,{iconClassName:"fas fa-chevron-left",disabled:0===t.length,text:"last start",onClick:this.goToLastStart}),Object(a.jsx)(v,{iconClassName:"fas fa-chevron-right",disabled:0===t.length,text:"next end ",onClick:this.goToNextEnd})]}),Object(a.jsx)(Z,{className:"my-1",duration:this.state.totalTime,currentTime:this.state.currentTime,onSelectNewTime:function(t){var n;return null===(n=e.VideoPlayerRef.current)||void 0===n?void 0:n.setTime(t)},captions:t,onCaptionSelected:this.captionSelectionToggle,selectedCaption_i:n,onCaptionChanged:this.changeCaptionUIHandler}),Object(a.jsx)(M,{currentTime:this.state.currentTime,totalTime:this.state.totalTime,caption:null===n?null:t[n],captionIndex:null===n?-1:n,onCaptionChanged:this.changeCaptionUIHandler})]}),Object(a.jsxs)("div",{className:"d-flex justify-content-center my-2 download-form",children:[Object(a.jsx)("input",{className:"form-control",placeholder:"file-name.srt",value:this.state.subFileName,onChange:function(t){return e.setState({subFileName:t.currentTarget.value})}}),Object(a.jsx)("button",{className:"btn btn-danger",onClick:this.saveFile,children:Object(a.jsxs)("strong",{children:[" save as a file ",Object(a.jsx)("span",{className:"fas fa-file"}),"  "]})})]})]})}}]),n}(s.a.Component),Y=(n(75),n.p+"static/media/captionDrag.0dcd63ca.gif"),$=n.p+"static/media/TimeControll.ba1b4269.jpg",q=n.p+"static/media/stickTime.ee5d02c9.png",K=n.p+"static/media/textAlign.5bd9ab79.png",Q=n.p+"static/media/addNewCaptionToEndOfLastOne.abf13990.jpg",ee=n.p+"static/media/resizeVideo.342db664.png",te=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={shortcuts:[{keys:["ctrl","space"],clue:"play/pause video player"},{keys:["ctrl","right/left"],clue:"go forward/backward in timeline [small step]"},{keys:["ctrl","shift","right/left"],clue:"go forward/backward in timeline [big step]"},{keys:["ctrl","+/-"],clue:"zoom in/out in timeline"},{keys:["ctrl","shift","+/-"],clue:"zoom in/out web page"},{keys:["ctrl","6/7"],clue:"go to [start of last caption]/[end of next caption]"},{keys:["ctrl","down"],clue:"select current caption"},{keys:["escape"],clue:"unselect selected caption"},{keys:["tab","left/right"],clue:"shoot end of selected caption forward/backward"},{keys:["alt","left/right"],clue:"shoot start of selected caption forward/backward"},{keys:["ctrl","8/9"],clue:"shoot start/end of selected caption to the current time"},{keys:["ctrl","enter"],clue:"create new caption"},{keys:["enter"],clue:"updates caption value, it works automatically when you switch between captions too"},{keys:["ctrl","delete"],clue:"delete selected caption"},{keys:["ctrl","0"],clue:"toggle text direction in caption editor input [left to right]/[right to left]"},{keys:["ctrl","z/y"],clue:"undo/redo"},{keys:["ctrl","s"],clue:"save subtitle"}],features:[{imageSrc:Y,details:"you can drag head/tail of the captions to extend/limit the timing of the caption. \n        dragCaption.GIF                  you can also drag center of the caption to move caption forward/backward in time."},{imageSrc:$,details:"you can change timestamp manually by double clicking on it\n        changes will be applied after clicking out of the timestamp"},{imageSrc:q,details:"use stick time button to stick start/end of selected caption to the timeline cursor"},{imageSrc:K,details:"you can change text align according to the language you write in"},{imageSrc:Q,details:"if you add a new caption to the last 600ms of the last caption, the new caption will be inserted after last one"},{imageSrc:ee,details:"you can resize video by draging the thin line after video and before caption view"}]},e}return Object(l.a)(n,[{key:"render",value:function(){return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h2",{className:"page-title",children:"Help"}),Object(a.jsxs)("div",{className:"wrapper",children:[Object(a.jsxs)("h3",{children:[" ",Object(a.jsx)("a",{href:"#features",children:"#features"})," "]}),Object(a.jsx)("ul",{id:"features",children:this.state.features.map((function(e){return Object(a.jsxs)("li",{children:[Object(a.jsx)("img",{src:e.imageSrc,className:"d-block",alt:""}),Object(a.jsxs)("span",{children:[" ",e.details," "]})]})}))}),Object(a.jsxs)("h3",{children:[" ",Object(a.jsx)("a",{href:"#shortcuts",children:"#shortcuts"})," "]}),Object(a.jsx)("ul",{id:"shortcuts",children:this.state.shortcuts.map((function(e){return Object(a.jsxs)("li",{className:"shortcut d-flex justify-content-between",children:[Object(a.jsx)("span",{className:"keys",children:e.keys.map((function(e,t){return Object(a.jsxs)(a.Fragment,{children:[0!==t?Object(a.jsx)("span",{className:"plus",children:"+"}):"",Object(a.jsx)("code",{className:"key",children:e})]})}))}),Object(a.jsxs)("span",{className:"clue",children:[" ",e.clue," "]})]})}))})]})]})}}]),n}(s.a.Component),ne=(n(76),function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)(h.a,{basename:"/subtitle-editor",children:[Object(a.jsx)(p.b,{exact:!0,path:"/",component:D}),Object(a.jsx)(p.b,{exact:!0,path:"/studio",component:J}),Object(a.jsx)(p.b,{exact:!0,path:"/help",component:te})]}),Object(a.jsx)(C,{})]})}}]),n}(s.a.Component));c.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(ne,{})}),document.getElementById("root"))}},[[77,1,2]]]);
//# sourceMappingURL=main.e4ee6312.chunk.js.map